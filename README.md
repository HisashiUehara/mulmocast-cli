# mulmocast

A CLI tool for generating podcast and video content from script files (MulmoScript). Automates the process of creating audio, images, and video from structured MulmoScript files.

## What is MulmoScript?

**MulmoScript** is a simple JSON/YAML format for describing multi-modal content.  
You can define speakers, text, images, and layout — all in one script.

A Hello World script is available in [./docs/scripts](./docs/scripts).   
See [MulmoScript Format](#mulmoscript-format) for details on the structure.

## Installation

```bash
npm install -g mulmocast
```

You'll also need to install ffmpeg:
```bash
# For macOS with Homebrew
brew install ffmpeg

# For other platforms
# Visit https://ffmpeg.org/download.html
```

## Configuration

Create a `.env` file in your project directory with the following API keys:

### Required
```bash
OPENAI_API_KEY=your_openai_api_key
```
### Optional
```bash
DEFAULT_OPENAI_IMAGE_MODEL=gpt-image-1 # for the advanced image generation model
GOOGLE_PROJECT_ID=your_google_project_id # for Google's image generation model
NIJIVOICE_API_KEY=your_nijivoice_api_key # for Nijivoice's TTS model
BROWSERLESS_API_TOKEN=your_browserless_api_token # to access web in mulmo-tool
```

## Workflow

1. Create a MulmoScript JSON file with `mulmo-tool scripting`
2. Generate audio with `mulmo audio`
3. Generate images with `mulmo images` 
4. Create final video with `mulmo movie`

## Quick Start

```bash
# Generate script with interactive mode
mulmo-tool scripting -i -t children_book -o ./ -s story
```
After running this command, you'll create a story script through an interactive conversation with the AI.

```bash
# Generate both audio and images, then combine into video
mulmo movie {generated_script_file}
```
Replace `{generated_script_file}` with the output file from the previous command, such as `story-1746600802426.json`.

## Generate MulmoScript

```bash
# Generate script from web content
mulmo-tool scripting -u https://example.com

# Generate script with interactive mode
mulmo-tool scripting -i
```

## Generate content from MulmoScript

Mulmo provides several commands to handle different aspects of content creation:

```bash
# Generate audio from script
mulmo audio script.json

# Generate images for script
mulmo images script.json

# Generate both audio and images, then combine into video
mulmo movie script.json

# Translate script to Japanese
mulmo translate script.json
```

## Cache and Re-run
When running the same `mulmo` command multiple times, previously generated files are treated as cache. For example, audio or image files will not be regenerated if they already exist.

To force regeneration, delete the old files — including temporary files — under the output directory before re-running the command or use -f (force) option.

If you modify the text or instruction fields in a MulmoScript, mulmo will automatically detect the changes and regenerate the corresponding audio content upon re-run.

## MulmoScript Format

MulmoScript is a JSON format to define podcast or video scripts:
Schema definition: [schema.ts](./src/types/schema.ts)

## Sample MulmoScript

https://github.com/receptron/mulmocast-cli/tree/main/scripts

## Directory Structure

| Directory         | Description                                                                 |
|-------------------|-----------------------------------------------------------------------------|
| `output/`         | Artifacts generated by commands — e.g., `.json`, audio, and video files    |
| `output/audio/`   | Temporary audio fragments used in the final audio assembly                  |
| `output/images/`  | Image files generated by the `images` command                               |
| `output/cache/`   | Internal cache files for various processing steps                           |

> These directories are automatically created as needed by the `mulmo` commands.

## Help

CLI Usage

### `mulmo -h` Output
Use this command to generate content (audio, images, movie) from an existing MulmoScript.

```bash
mulmo -h
```
```bash
mulmo <action> <file>

Run mulmocast

Positionals:
  action  action to perform
       [string] [choices: "translate", "audio", "images", "movie", "preprocess"]
  file    Mulmo Script File                                             [string]

Options:
      --version   Show version number                                  [boolean]
  -v, --verbose   verbose log              [boolean] [required] [default: false]
  -o, --outdir    output dir                                            [string]
  -b, --basedir   base dir                                              [string]
  -a, --audiodir  audio dir                                             [string]
  -i, --imagedir  image dir                                             [string]
  -f, --force     force generate                      [boolean] [default: false]
      --help      Show help                                            [boolean]

```

### `mulmo-tool -h` Output
Use this command to generate a new MulmoScript from a URL or interactively.

```bash
mulmo-tool -h
```

```bash
mulmo-tool <action>

Run mulmocast tool

Positionals:
  action  action to perform            [string] [choices: "scripting", "prompt"]

Options:
      --version      Show version number                               [boolean]
  -v, --verbose      verbose log           [boolean] [required] [default: false]
  -o, --outdir       output dir                                         [string]
  -b, --basedir      base dir                                           [string]
  -u, --url          URLs to reference (required when not in interactive mode)
                                                           [array] [default: []]
  -i, --interactive  Generate script in interactive mode with user prompts
                                                                       [boolean]
  -t, --template     Template name to use
   [string] [choices: "business", "children_book", "coding", "podcast_standard",
                                                              "sensei_and_taro"]
  -c, --cache        cache dir                                          [string]
  -s, --script       script filename                [string] [default: "script"]
      --help         Show help                                         [boolean]
```


## Contributing

For developers interested in contributing to this project, please see [CONTRIBUTING.md](./CONTRIBUTING.md).

